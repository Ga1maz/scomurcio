#!/bin/bash

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∑–∞–ø—É—Å–∫ –æ—Ç root
if [ "$(id -u)" -ne 0 ]; then
    echo -e "üö´ \e[1;31m–û—à–∏–±–∫–∞: –≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –¥–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è —Å –ø—Ä–∞–≤–∞–º–∏ root!\e[0m" >&2
    exit 1
fi

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –º–µ–Ω—é
show_menu() {
    clear
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–∑–∏—Ü–∏—é –∫—É—Ä—Å–æ—Ä–∞
    tput sc
    
    # –û—á–∏—â–∞–µ–º —Ç–æ–ª—å–∫–æ –æ–±–ª–∞—Å—Ç—å –º–µ–Ω—é (20 —Å—Ç—Ä–æ–∫ —Å–Ω–∏–∑—É)
    tput cup 0 0
    echo -ne "\e[0m"
    for i in {1..20}; do
        tput el
        echo ""
    done
    tput rc
    
    # –í—ã–≤–æ–¥–∏–º –º–µ–Ω—é
    echo -e "\e[1;36m"
    echo "  ____   ____ ___  __  __   _   _ ____   ____ ___  ___  "
    echo " / ___| / ___/ _ \|  \/  | | | | |  _ \ / ___|_ _|/ _ \ "
    echo " \___ \| |  | | | | |\/| | | | | | |_) | |    | | | | | |"
    echo "  ___) | |__| |_| | |  | | | |_| |  _ <| |___ | | | |_| |"
    echo " |____/ \____\___/|_|  |_|  \___/|_| \_\\____|___|\___/ "
    echo -e "\e[1;33m             üöÄ –°–ö–†–ò–ü–¢ –û–¢ GA1MAZ.RU \e[0m"
    echo ""

    echo -e "\e[1;34müìä –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ:\e[0m"
    echo -e "üñ•Ô∏è  \e[1;33mIP-–∞–¥—Ä–µ—Å:\e[0m \e[0;32m$(hostname -I 2>/dev/null | awk '{print $1}' || echo "–ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ")\e[0m"
    echo -e "üß† \e[1;33m–û–ó–£:\e[0m \e[0;32m$(free -h | awk '/Mem/{print $3 "/" $2}')\e[0m"
    echo -e "üíæ \e[1;33m–î–∏—Å–∫:\e[0m \e[0;32m$(df -h / | awk 'NR==2{print $3 "/" $2}')\e[0m"
    echo ""

    echo -e "\e[1;34müëë –í–ª–∞–¥–µ–ª–µ—Ü:\e[0m \e[0;35mga1maz.ru\e[0m"
    echo -e "\e[1;34müìú –õ–∏—Ü–µ–Ω–∑–∏—è:\e[0m \e[0;35mMIT\e[0m"
    echo ""

    echo -e "\e[1;34müîç –í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:\e[0m"
    echo -e "\e[1;32m1). üå°Ô∏è BME280 (–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞/–í–ª–∞–∂–Ω–æ—Å—Ç—å/–î–∞–≤–ª–µ–Ω–∏–µ)\e[0m"
    echo -e "\e[1;32m2). üéÆ MPU6050 (–ê–∫—Å–µ–ª–µ—Ä–æ–º–µ—Ç—Ä/–ì–∏—Ä–æ—Å–∫–æ–ø)\e[0m"
    echo -e "\e[1;32m3). üîÑ –≠–Ω–∫–æ–¥–µ—Ä (–†–æ—Ç–∞—Ü–∏–æ–Ω–Ω—ã–π —ç–Ω–∫–æ–¥–µ—Ä)\e[0m"
    echo -e "\e[1;32m4). üóëÔ∏è –£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª—ã\e[0m"
    echo -e "\e[1;31m0). ‚ùå –í—ã—Ö–æ–¥\e[0m"
    echo ""
}

# –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –ø—Ä–æ–≥—Ä–∞–º–º—ã
while true; do
    show_menu
    
    # –û–∂–∏–¥–∞–µ–º –≤–≤–æ–¥–∞ –±–µ–∑ –º–∏–≥–∞–Ω–∏—è
    read -p "–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –ø—É–Ω–∫—Ç–∞ (0-4): " -n 1 -s choice
    echo ""
    echo ""

    case $choice in
        1)
            echo -e "\e[1;34m–í—ã–±—Ä–∞–Ω BME280 (–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞/–í–ª–∞–∂–Ω–æ—Å—Ç—å/–î–∞–≤–ª–µ–Ω–∏–µ)\e[0m"
            # –≠–º—É–ª—è—Ü–∏—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞—Ç—á–∏–∫–æ–º
            echo -e "\e[1;33m–ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö...\e[0m"
            echo -e "–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞: \e[1;32m25.4¬∞C\e[0m"
            echo -e "–í–ª–∞–∂–Ω–æ—Å—Ç—å: \e[1;32m45%\e[0m"
            echo -e "–î–∞–≤–ª–µ–Ω–∏–µ: \e[1;32m1013.25 hPa\e[0m"
            read -n 1 -s -p "–ù–∞–∂–º–∏—Ç–µ –ª—é–±—É—é –∫–ª–∞–≤–∏—à—É –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..."
            ;;
        2)
            echo -e "\e[1;34m–í—ã–±—Ä–∞–Ω MPU6050 (–ê–∫—Å–µ–ª–µ—Ä–æ–º–µ—Ç—Ä/–ì–∏—Ä–æ—Å–∫–æ–ø)\e[0m"
            # –≠–º—É–ª—è—Ü–∏—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞—Ç—á–∏–∫–æ–º
            echo -e "\e[1;33m–ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö...\e[0m"
            echo -e "–£—Å–∫–æ—Ä–µ–Ω–∏–µ X: \e[1;32m0.12 g\e[0m"
            echo -e "–£—Å–∫–æ—Ä–µ–Ω–∏–µ Y: \e[1;32m0.05 g\e[0m"
            echo -e "–£—Å–∫–æ—Ä–µ–Ω–∏–µ Z: \e[1;32m1.02 g\e[0m"
            read -n 1 -s -p "–ù–∞–∂–º–∏—Ç–µ –ª—é–±—É—é –∫–ª–∞–≤–∏—à—É –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..."
            ;;
        3)
            echo -e "\e[1;34m–í—ã–±—Ä–∞–Ω –≠–Ω–∫–æ–¥–µ—Ä (–†–æ—Ç–∞—Ü–∏–æ–Ω–Ω—ã–π —ç–Ω–∫–æ–¥–µ—Ä)\e[0m"
            # –≠–º—É–ª—è—Ü–∏—è —Ä–∞–±–æ—Ç—ã —Å –¥–∞—Ç—á–∏–∫–æ–º
            echo -e "\e[1;33m–ß—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö...\e[0m"
            echo -e "–ü–æ–ª–æ–∂–µ–Ω–∏–µ: \e[1;32m127 —à–∞–≥–æ–≤\e[0m"
            echo -e "–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: \e[1;32m–ü–æ —á–∞—Å–æ–≤–æ–π\e[0m"
            read -n 1 -s -p "–ù–∞–∂–º–∏—Ç–µ –ª—é–±—É—é –∫–ª–∞–≤–∏—à—É –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..."
            ;;
        4)
            echo -e "\e[1;34müóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤\e[0m"
            read -p "–í–≤–µ–¥–∏—Ç–µ –ø—É—Ç—å –∫ —Ñ–∞–π–ª–∞–º –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è: " filepath
            
            if [ -e "$filepath" ]; then
                echo -e "\e[1;33m–í—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å '$filepath'? [y/N]\e[0m"
                read -n 1 confirmation
                echo ""
                
                if [[ "$confirmation" =~ [yY–¥–î] ]]; then
                    rm -rf "$filepath" && echo -e "\e[1;32m–§–∞–π–ª—ã —É—Å–ø–µ—à–Ω–æ —É–¥–∞–ª–µ–Ω—ã!\e[0m" || echo -e "\e[1;31m–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏!\e[0m"
                else
                    echo -e "\e[1;33m–£–¥–∞–ª–µ–Ω–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ\e[0m"
                fi
            else
                echo -e "\e[1;31m–û—à–∏–±–∫–∞: –£–∫–∞–∑–∞–Ω–Ω—ã–π –ø—É—Ç—å –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç!\e[0m"
            fi
            read -n 1 -s -p "–ù–∞–∂–º–∏—Ç–µ –ª—é–±—É—é –∫–ª–∞–≤–∏—à—É –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è..."
            ;;
        0)
            echo -e "\e[1;34m–í—ã—Ö–æ–¥ –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã...\e[0m"
            exit 0
            ;;
        *)
            echo -e "\e[1;31m–û—à–∏–±–∫–∞: –ù–µ–≤–µ—Ä–Ω—ã–π –≤—ã–±–æ—Ä! –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–≤–µ–¥–∏—Ç–µ —á–∏—Å–ª–æ –æ—Ç 0 –¥–æ 4.\e[0m"
            sleep 1
            ;;
    esac
done
